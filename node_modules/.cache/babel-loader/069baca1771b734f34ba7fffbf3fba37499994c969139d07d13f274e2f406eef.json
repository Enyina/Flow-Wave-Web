{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\Documents\\\\flow wave\\\\src\\\\contexts\\\\AuthProvider.js\",\n  _s = $RefreshSig$();\n// src/context/AuthProvider.js\nimport React, { createContext, useCallback, useEffect, useMemo, useState } from 'react';\nimport { authApi } from '../api/authApi';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext(undefined);\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [token, setToken] = useState(() => localStorage.getItem('accessToken'));\n  const [user, setUser] = useState(() => {\n    const email = localStorage.getItem('authEmail');\n    return email ? {\n      email\n    } : null;\n  });\n  useEffect(() => {\n    if (token) localStorage.setItem('accessToken', token);else localStorage.removeItem('accessToken');\n  }, [token]);\n  useEffect(() => {\n    if (user !== null && user !== void 0 && user.email) localStorage.setItem('authEmail', user.email);else localStorage.removeItem('authEmail');\n  }, [user]);\n  useEffect(() => {\n    const handler = () => {\n      setToken(null);\n      setUser(null);\n    };\n    window.addEventListener('auth:logout', handler);\n    return () => window.removeEventListener('auth:logout', handler);\n  }, []);\n  const login = useCallback(async dto => {\n    const data = await authApi.login(dto);\n    setToken(data.accessToken);\n    setUser({\n      email: dto.email\n    });\n  }, []);\n  const logout = useCallback(() => {\n    setToken(null);\n    setUser(null);\n    localStorage.removeItem('accessToken');\n    localStorage.removeItem('authEmail');\n  }, []);\n  const signup = useCallback(async dto => {\n    const res = await authApi.signup(dto);\n    setUser({\n      email: dto.email\n    });\n    return res;\n  }, []);\n  const verifyEmail = useCallback(async (email, code) => {\n    const res = await authApi.verifyEmail({\n      email,\n      code\n    });\n    return {\n      token: res.token\n    };\n  }, []);\n  const createPassword = useCallback(async (tokenArg, password) => {\n    await authApi.createPassword(tokenArg, password);\n  }, []);\n  const forgotPassword = useCallback(async email => {\n    await authApi.forgotPassword({\n      email\n    });\n  }, []);\n  const resetPassword = useCallback(async (tokenArg, password) => {\n    await authApi.resetPassword(tokenArg, password);\n  }, []);\n  const createPin = useCallback(async pin => {\n    await authApi.createPin({\n      pin\n    });\n  }, []);\n  const value = useMemo(() => ({\n    user,\n    token,\n    isAuthenticated: !!token,\n    login,\n    logout,\n    signup,\n    verifyEmail,\n    createPassword,\n    forgotPassword,\n    resetPassword,\n    createPin\n  }), [user, token, login, logout, signup, verifyEmail, createPassword, forgotPassword, resetPassword, createPin]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 10\n  }, this);\n};\n_s(AuthProvider, \"J67i4/HqaTGWYJF03/Rcl9G/SDo=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useCallback","useEffect","useMemo","useState","authApi","jsxDEV","_jsxDEV","AuthContext","undefined","AuthProvider","children","_s","token","setToken","localStorage","getItem","user","setUser","email","setItem","removeItem","handler","window","addEventListener","removeEventListener","login","dto","data","accessToken","logout","signup","res","verifyEmail","code","createPassword","tokenArg","password","forgotPassword","resetPassword","createPin","pin","value","isAuthenticated","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/HP/Documents/flow wave/src/contexts/AuthProvider.js"],"sourcesContent":["// src/context/AuthProvider.js\r\nimport React, { createContext, useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { authApi } from '../api/authApi';\r\n\r\nexport const AuthContext = createContext(undefined);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [token, setToken] = useState(() => localStorage.getItem('accessToken'));\r\n  const [user, setUser] = useState(() => {\r\n    const email = localStorage.getItem('authEmail');\r\n    return email ? { email } : null;\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (token) localStorage.setItem('accessToken', token);\r\n    else localStorage.removeItem('accessToken');\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    if (user?.email) localStorage.setItem('authEmail', user.email);\r\n    else localStorage.removeItem('authEmail');\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    const handler = () => {\r\n      setToken(null);\r\n      setUser(null);\r\n    };\r\n    window.addEventListener('auth:logout', handler);\r\n    return () => window.removeEventListener('auth:logout', handler);\r\n  }, []);\r\n\r\n  const login = useCallback(async (dto) => {\r\n    const data = await authApi.login(dto);\r\n    setToken(data.accessToken);\r\n    setUser({ email: dto.email });\r\n  }, []);\r\n\r\n  const logout = useCallback(() => {\r\n    setToken(null);\r\n    setUser(null);\r\n    localStorage.removeItem('accessToken');\r\n    localStorage.removeItem('authEmail');\r\n  }, []);\r\n\r\n  const signup = useCallback(async (dto) => {\r\n    const res = await authApi.signup(dto);\r\n    setUser({ email: dto.email });\r\n    return res;\r\n  }, []);\r\n\r\n  const verifyEmail = useCallback(async (email, code) => {\r\n    const res = await authApi.verifyEmail({ email, code });\r\n    return { token: res.token };\r\n  }, []);\r\n\r\n  const createPassword = useCallback(async (tokenArg, password) => {\r\n    await authApi.createPassword(tokenArg, password);\r\n  }, []);\r\n\r\n  const forgotPassword = useCallback(async (email) => {\r\n    await authApi.forgotPassword({ email });\r\n  }, []);\r\n\r\n  const resetPassword = useCallback(async (tokenArg, password) => {\r\n    await authApi.resetPassword(tokenArg, password);\r\n  }, []);\r\n\r\n  const createPin = useCallback(async (pin) => {\r\n    await authApi.createPin({ pin });\r\n  }, []);\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      user,\r\n      token,\r\n      isAuthenticated: !!token,\r\n      login,\r\n      logout,\r\n      signup,\r\n      verifyEmail,\r\n      createPassword,\r\n      forgotPassword,\r\n      resetPassword,\r\n      createPin,\r\n    }),\r\n    [user, token, login, logout, signup, verifyEmail, createPassword, forgotPassword, resetPassword, createPin]\r\n  );\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}